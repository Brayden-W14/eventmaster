(()=>{var e={};e.id=814,e.ids=[814],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4770:e=>{"use strict";e.exports=require("crypto")},665:e=>{"use strict";e.exports=require("dns")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},5816:e=>{"use strict";e.exports=require("process")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},7407:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>l}),s(8945),s(2029),s(5866);var t=s(3191),a=s(8716),i=s(7922),n=s.n(i),o=s(5231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(r,d);let l=["",{children:["admin",{children:["reviewReservations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8945)),"C:\\Users\\BW214\\OneDrive\\Desktop\\eventmaster\\eventmaster\\src\\app\\admin\\reviewReservations\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"C:\\Users\\BW214\\OneDrive\\Desktop\\eventmaster\\eventmaster\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\BW214\\OneDrive\\Desktop\\eventmaster\\eventmaster\\src\\app\\admin\\reviewReservations\\page.tsx"],u="/admin/reviewReservations/page",p={require:s,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/reviewReservations/page",pathname:"/admin/reviewReservations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},1371:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},6410:()=>{},6345:(e,r,s)=>{Promise.resolve().then(s.bind(s,2547))},5124:(e,r,s)=>{"use strict";s.d(r,{I:()=>d,db:()=>o});var t=s(5724),a=s(2585),i=s(76);s(32);let n=(0,a.ZF)({apiKey:"AIzaSyCHCfOYdJGc7lpbNHeE7-pz0-wk2Y0ywM0",authDomain:"eventmaster-database.firebaseapp.com",projectId:"eventmaster-database",storageBucket:"eventmaster-database.firebaseapp.com",messagingSenderId:"594662023462",appId:"1:594662023462:web:ec42c0d6f019882bdf61e7",measurementId:"G-3PQRS2J4ZD"}),o=(0,i.ad)(n),d=(0,t.v0)(n)},2547:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>d});var t=s(326),a=s(7577),i=s(5124),n=s(76),o=s(5047);let d=()=>{let[e,r]=(0,a.useState)([]),[s,d]=(0,a.useState)(""),[l,c]=(0,a.useState)(!0),[u,p]=(0,a.useState)(null),[h,x]=(0,a.useState)(!1),[m,g]=(0,a.useState)([]),[v,f]=(0,a.useState)([]),[b,k]=(0,a.useState)(!1),[w,y]=(0,a.useState)(null),[j,P]=(0,a.useState)(null),C=(0,o.useRouter)();(0,a.useEffect)(()=>{x(!0)},[]),(0,a.useEffect)(()=>{h&&(async()=>{let e=i.I.currentUser;if(!e){C.push("/signin");return}try{let r=(0,n.JU)(i.db,"users",e.uid),s=await (0,n.QT)(r);if(s.exists()){let e=s.data();e&&e.isAdmin?p(!0):(p(!1),C.push("/dashboard"))}else p(!1),C.push("/dashboard")}catch(e){console.error("Error checking admin status:",e),p(!1),C.push("/dashboard")}})()},[h,C]),(0,a.useEffect)(()=>{(async()=>{try{let e=(0,n.hJ)(i.db,"pending_reservations"),s=await (0,n.PL)(e),t=[];for(let e of s.docs){let r=e.data();if("pending"===r.status){let s=(0,n.JU)(i.db,"veneus",r.venueId),a=await (0,n.QT)(s);if(a.exists()){let s=a.data()?.ven_name;t.push({...r,id:e.id,venueName:s||"Unknown Venue"})}else t.push({...r,id:e.id,venueName:"Unknown Venue"})}}r(t)}catch(e){console.error("Error fetching pending reservations:",e),d("Failed to fetch pending reservations. Please try again later.")}finally{c(!1)}})()},[u]),(0,a.useEffect)(()=>{(async()=>{try{let e=(0,n.hJ)(i.db,"users"),r=(0,n.IO)(e,(0,n.ar)("isWorker","==",!0)),s=(await (0,n.PL)(r)).docs.map(e=>({id:e.id,name:e.data().name}));g(s)}catch(e){console.error("Error fetching workers:",e)}})()},[]);let R=async e=>{if(2!==v.length){d("Please select exactly two workers.");return}try{let s=(0,n.JU)(i.db,"pending_reservations",e),t=await (0,n.QT)(s);if(!t.exists())throw Error("Reservation not found.");let a=t.data(),o=a.date,l=new Set;for(let r of v){let s=(0,n.IO)((0,n.hJ)(i.db,"pending_reservations"),(0,n.ar)("assignedWorkers","array-contains",r),(0,n.ar)("date","==",o)),t=(0,n.IO)((0,n.hJ)(i.db,"confirmed_reservations"),(0,n.ar)("assignedWorkers","array-contains",r),(0,n.ar)("date","==",o)),[a,d]=await Promise.all([(0,n.PL)(s),(0,n.PL)(t)]);a.forEach(s=>{s.data().date===o&&s.id!==e&&l.add(r)}),d.forEach(e=>{e.data().date===o&&l.add(r)})}if(l.size>0){let e=[];for(let r of l){let s=(0,n.JU)(i.db,"users",r),t=await (0,n.QT)(s);if(t.exists()){let r=t.data(),s=r?.name||"Unknown Worker";e.push(s)}}d(`Worker(s) ${e.join(", ")} are already assigned to other reservations on this date.`);return}await (0,n.r7)(s,{...a,assignedWorkers:v}),d("Workers assigned to pending reservation successfully."),r(r=>r.map(r=>r.id===e?{...r,assignedWorkers:v}:r)),k(!1)}catch(e){console.error("Error assigning workers:",e),d("Error assigning workers. Please try again.")}},E=async(s,t)=>{let a=e.find(e=>e.id===s);if("confirm"===t&&a&&(!a.assignedWorkers||2!==a.assignedWorkers.length)){d("Please assign exactly two workers to confirm the reservation.");return}try{let e=(0,n.JU)(i.db,"pending_reservations",s),o=await (0,n.QT)(e);if(!o.exists())throw Error("Reservation does not exist.");if("confirm"===t){let r=(0,n.JU)(i.db,"confirmed_reservations",s),t=o.data();await (0,n.pl)(r,{...t,assignedWorkers:a.assignedWorkers,status:"confirmed",price:t.price}),await (0,n.oe)(e)}else"deny"===t&&await (0,n.r7)(e,{status:"denied"});d(`Reservation ${t}ed successfully.`),r(e=>e.filter(e=>e.id!==s))}catch(e){console.error("Error processing reservation:",e),d("Error processing reservation. Please try again.")}},W=async e=>{try{let s=(0,n.JU)(i.db,"pending_reservations",e),t=await (0,n.QT)(s);if(!t.exists())throw Error("Reservation not found.");t.data(),await (0,n.r7)(s,{assignedWorkers:[]}),d("Assigned workers cleared successfully."),r(r=>r.map(r=>r.id===e?{...r,assignedWorkers:[]}:r))}catch(e){console.error("Error clearing workers:",e),d("Error clearing workers. Please try again.")}},_=(e,r)=>{y(e),P(r),k(!0)};if(null===u)return t.jsx("p",{children:"Loading..."});let q=e=>{f(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,t.jsxs)("div",{children:[t.jsx("h1",{children:"Review Pending Reservations"}),s&&t.jsx("p",{children:s}),l?t.jsx("p",{children:"Loading..."}):t.jsx("div",{children:0===e.length?t.jsx("p",{children:"No pending reservations to review."}):t.jsx("div",{children:e.map(e=>(0,t.jsxs)("div",{className:"reservation-item",children:[(0,t.jsxs)("h2",{children:[t.jsx("strong",{children:"Name:"})," ",e.name]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Venue:"})," ",e.venueName]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Reservation Date:"})," ",e.date]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Attendees:"})," ",e.attendees]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Price:"})," ",e.price]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Payment Method:"})," ",e.paymentMethod]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Status:"})," ",e.status]}),(0,t.jsxs)("div",{className:"action-buttons",children:[t.jsx("button",{onClick:()=>_(e.id,e.name),className:"assign-workers-btn",style:{backgroundColor:"blue",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Assign Workers"}),t.jsx("button",{onClick:()=>E(e.id,"confirm"),className:"confirm-btn",style:{backgroundColor:"green",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Confirm"}),t.jsx("button",{onClick:()=>E(e.id,"deny"),className:"deny-btn",style:{backgroundColor:"red",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Deny"}),t.jsx("button",{onClick:()=>W(e.id),className:"clear-workers-btn",style:{backgroundColor:"orange",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Clear Workers"})]})]},e.id))})}),b&&w&&(0,t.jsxs)("div",{className:"worker-modal",children:[(0,t.jsxs)("h2",{children:["Select Workers for the Reservation: '",j,"'"]}),t.jsx("div",{className:"worker-list",children:m.map(e=>(0,t.jsxs)("div",{children:[t.jsx("input",{type:"checkbox",id:e.id,checked:v.includes(e.id),onChange:()=>q(e.id)}),t.jsx("label",{htmlFor:e.id,children:e.name})]},e.id))}),(0,t.jsxs)("div",{className:"worker-modal-actions",style:{display:"flex",gap:"10px",justifyContent:"center"},children:[t.jsx("button",{onClick:()=>R(w),style:{backgroundColor:"blue",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Assign Workers"}),t.jsx("button",{onClick:()=>k(!1),style:{backgroundColor:"gray",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Close"})]})]}),t.jsx("button",{onClick:()=>C.push("/dashboard"),style:{display:"block",margin:"20px auto",padding:"10px",fontSize:"16px",backgroundColor:"#6c757d",color:"#FFF",border:"none",borderRadius:"4px",cursor:"pointer",maxWidth:"200px"},children:"Back to Home"})]})}},8945:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(8570).createProxy)(String.raw`C:\Users\BW214\OneDrive\Desktop\eventmaster\eventmaster\src\app\admin\reviewReservations\page.tsx#default`)},2029:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l,metadata:()=>d});var t=s(9510),a=s(9355),i=s.n(a),n=s(1711),o=s.n(n);s(5023);let d={title:"Create Next App",description:"Generated by create next app"};function l({children:e}){return t.jsx("html",{lang:"en",children:t.jsx("body",{className:`${i().variable} ${o().variable} antialiased`,children:e})})}},3881:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var t=s(6621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,t.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[948,500,339,695],()=>s(7407));module.exports=t})();